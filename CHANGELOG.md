# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [Unreleased]

### Changed
- **BREAKING**: Removed `django-cid` dependency in favor of `django-structlog`'s built-in request_id
  - `request_id` is now automatically generated by `django-structlog.middlewares.RequestMiddleware`
  - Removed `cid.middleware.CidMiddleware` from `AUDIT_MIDDLEWARE`
  - Removed `cid.apps.CidAppConfig` from `UTILS_APPS`
  - Auditlog now uses `request_id` from django-structlog via `oxutils.audit.utils.get_request_id()`
  - The `cid` field in auditlog entries now contains the `request_id` for correlation

### Migration Guide
If you were using `django-cid` directly:
- Replace `from cid.locals import get_cid` with `from oxutils.audit.utils import get_request_id`
- The `request_id` is now available in structlog context: `structlog.contextvars.get_contextvars().get('request_id')`
- Auditlog entries still use the `cid` field but it now contains the `request_id` from django-structlog

## [0.1.3] - 2024-12-08

### Added
- Context processor for site name and domain (`oxutils.context.site_name_processor`)
  - Provides `site_name` and `site_domain` from settings to templates
  - Easy integration with Django templates

## [0.1.0] - 2024-12-02

### Added

#### Core Features
- JWT authentication with RS256 and JWKS support
- Four S3 storage backends (Static, PublicMedia, PrivateMedia, LogStorage)
- Structured logging with `structlog` and correlation IDs
- Audit system with automatic change tracking and S3 export
- Celery integration with structured logging
- Pydantic-based settings management

#### Django Mixins
- `UUIDPrimaryKeyMixin` - UUID primary keys
- `TimestampMixin` - Automatic created_at/updated_at
- `BaseModelMixin` - Combined UUID + timestamps + is_active
- `NameMixin` - Name and description fields
- `UserTrackingMixin` - created_by/updated_by tracking
- `BaseService` - Service layer with exception handling

#### Exceptions
- `APIException` base class with standardized format
- `NotFoundException` (404)
- `ValidationException` (400)
- `ConflictException` (409)
- `DuplicateEntryException` (409)
- `PermissionDeniedException` (403)
- `UnauthorizedException` (401)
- `InvalidParameterException` (400)
- `MissingParameterException` (400)
- `InternalErrorException` (500)

#### Utilities
- `get_absolute_url` - Build absolute URLs
- `validate_image` - Image validation with size limits
- `request_is_bound` - Check if request has data

#### Configuration
- Pre-configured Django apps (`UTILS_APPS`)
- Pre-configured middleware (`AUDIT_MIDDLEWARE`)
- Automatic S3 validation
- JWT key file validation

#### Documentation
- Comprehensive README
- Detailed documentation for all modules
- 126 passing tests with full coverage
- CI/CD with GitHub Actions

### Dependencies
- Django 5.0+
- Python 3.11+
- boto3, celery, django-ninja, pydantic-settings
- django-auditlog, django-structlog
- PyJWT, jwcrypto, cryptography

[Unreleased]: https://github.com/oxiliere/oxutils/compare/v0.1.3...HEAD
[0.1.3]: https://github.com/oxiliere/oxutils/compare/v0.1.0...v0.1.3
[0.1.0]: https://github.com/oxiliere/oxutils/releases/tag/v0.1.0
